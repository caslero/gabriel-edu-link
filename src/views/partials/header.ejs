<header class="bg-gradient-to-r from-cyan-200 to-blue-500 to-blue-700 shadow-md">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 flex items-center justify-between">
    <!-- Logo + Nombre -->
    <div class="flex items-center space-x-3">
      <% if (user) { %>
        <div class="bg-gray-50 rounded-full p-2">
          <img src="/img/imagotipo.png" alt="Logo EduLink" class="w-8 h-8">
        </div>
        <h1 class="text-xl font-bold bg-gradient-to-r from-sky-950 to-blue-500 text-transparent bg-clip-text">
          <% if (user.rol === 'Estudiante') { %>
            <a href="/estudiante/panel">EduLink</a>
          <% } else if (user.rol === 'Docente') { %>
            <a href="/docente/panel">EduLink</a>
          <% } else if (user.rol === 'Admin') { %>
            <a href="/admin/panel">EduLink</a>
          <% } %>
        </h1>
      <% } else { %>
        <div class="bg-gray-50 rounded-full p-2">
          <img src="/img/isotipo.png" alt="Logo EduLink" class="w-8 h-8">
        </div>
        <h1 class="text-xl font-bold bg-gradient-to-r from-sky-950 to-blue-500 text-transparent bg-clip-text">
          <a href="/">EduLink</a>
        </h1>
      <% } %>
    </div>

    <!-- Botón hamburguesa visible solo en sm -->
    <button id="menuToggle" class="text-white text-2xl sm:block md:hidden focus:outline-none">
      <i class="bi bi-list"></i>
    </button>

    <!-- Menú horizontal -->
    <nav class="hidden md:flex space-x-6 text-md font-medium text-blue-50">
      <% if (!user) { %>
        <!-- Usuario NO logueado -->
        <a href="/" class="hover:text-cyan-300 transition">Inicio</a>
        <a href="/registro-usuario" class="hover:text-cyan-300 transition">Registro</a>
        <a href="/login" class="hover:text-cyan-300 transition">Acceder</a>
      <% } else { %>
        <!-- Usuario logueado -->
        <div class="relative">
          <button id="profileToggle" class="flex items-center space-x-2 focus:outline-none">
            <img src="<%= user.foto || '/uploads/default.png' %>" alt="Perfil" class="w-10 h-10 rounded-full border-2 border-white">
          </button>
          <!-- Menú desplegable -->
          <div id="profileMenu" class="absolute right-0 mt-2 w-48 bg-white rounded shadow-lg hidden">
            <div class="p-4 text-center">
              <img src="<%= user.foto || '/uploads/default.png' %>" alt="Foto usuario" class="w-12 h-12 rounded-full mx-auto mb-2">
              <p class="font-semibold text-blue-600"><%= user.nombre %></p>
              <p class="text-sm text-gray-600"><%= user.rol %></p>
            </div>
            <div class="border-t">
              <% if (user.rol === 'Estudiante') { %>
                <a href="/estudiante/perfil" class="block px-4 py-2 text-blue-600 hover:bg-blue-50">Ver perfil</a>
              <% } else if (user.rol === 'Docente') { %>
                <a href="/docente/perfil" class="block px-4 py-2 text-blue-600 hover:bg-blue-50">Ver perfil</a>
              <% } else if (user.rol === 'Admin') { %>
                <a href="/admin/perfil" class="block px-4 py-2 text-blue-600 hover:bg-blue-50">Ver perfil</a>
              <% } %>
              <a href="/auth/logout" class="block px-4 py-2 text-red-600 hover:bg-red-50">Cerrar sesión</a>
            </div>
          </div>
        </div>
      <% } %>
    </nav>
  </div>

  <!-- Menú móvil -->
  <div id="mobileMenu" class="sm:block md:hidden hidden px-4 pb-4">
    <nav class="flex flex-col space-y-2 text-md font-medium text-white">
      <% if (!user) { %>
        <a href="/" class="hover:text-cyan-300 transition">Inicio</a>
        <a href="/registro-usuario" class="hover:text-cyan-300 transition">Registro</a>
        <a href="/login" class="hover:text-cyan-300 transition">Acceder</a>
      <% } else { %>
        <div class="bg-white rounded shadow p-4 text-center">
          <img src="<%= user.foto || '/img/usuario.png' %>" alt="Foto usuario" class="w-12 h-12 rounded-full mx-auto mb-2">
          <p class="font-semibold text-blue-600"><%= user.nombre %></p>
          <p class="text-sm text-gray-600"><%= user.rol %></p>

          <% if (user.rol === 'Estudiante') { %>
            <a href="/estudiante/perfil" class="block mt-2 text-blue-600 hover:underline">Ver perfil</a>
          <% } else if (user.rol === 'Docente') { %>
            <a href="/docente/perfil" class="block mt-2 text-blue-600 hover:underline">Ver perfil</a>
          <% } else if (user.rol === 'Admin') { %>
            <a href="/admin/perfil" class="block mt-2 text-blue-600 hover:underline">Ver perfil</a>
          <% } %>

          <a href="/auth/logout" class="block mt-1 text-red-600 hover:underline">Cerrar sesión</a>
        </div>
      <% } %>
    </nav>
  </div>
</header>


<script>
  const menuToggle = document.getElementById("menuToggle");
  const mobileMenu = document.getElementById("mobileMenu");
  const profileToggle = document.getElementById("profileToggle");
  const profileMenu = document.getElementById("profileMenu");

  if (menuToggle) {
    menuToggle.addEventListener("click", () => {
      mobileMenu.classList.toggle("hidden");
    });
  }

  if (profileToggle) {
    profileToggle.addEventListener("click", () => {
      profileMenu.classList.toggle("hidden");
    });
  }
</script>